---
title: "Movie reviewer"
author: "Bernart Mateusz 156072, Janiak Patryk 156053"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    logo: "./03_logotyp_pp_wersja_ang/PP_logotyp_ANG_WHITE.png"
runtime: shiny
---
<style>
.navbar-header {
    display: flex;
    align-items: center;
    flex-direction: column;
    margin-top: 10px;
}
.navbar-brand {
    display: flex;
    justify-content: space-between;
    width: calc(100vw - 20px);    
}
.shiny-html-output.shiny-bound-output {
  position: absolute;
  width: calc(100% - 10px);
  height: calc(100vh - 278px)!important;
  top: 278px; 
}
</style>
<!-- 268px offset + 10px padding -->


```{r global, include=FALSE}
library(flexdashboard)
library(ggplot2)
library(plotly)
library(dplyr)
library(gridExtra)
library(cowplot)
library(stringr)
library(tidyr)
library(grid)
library(flexdashboard)
library(ggplot2)
library(plotly)
library(ggsci)
library(shiny)
library(lorem)
library(ggsci)

movies <- read.csv2("./imdb-movies-dataset.csv", sep = ",", dec = ".")
movies <- movies[1:1000, ]
flat_movies <- movies %>%
    separate_rows(Genre, sep = ",")
```

Datatable
=====================================

Column {data-width=650}
-----------------------------------------------------------------------

### Datatable

```{r}
library(DT)
prettyTable <- function(table_df, round_columns_func=is.numeric, round_digits=2) {
    DT::datatable(table_df, style="bootstrap", escape = FALSE, filter = "top", rownames = FALSE, extensions = "Buttons", options = list(dom = 'Bfrtip', buttons = c('copy', 'csv', 'excel', 'pdf', 'print'))) %>%
    formatRound(unlist(lapply(table_df, round_columns_func)), round_digits)
}
prettyTable(movies %>% select(-c(Review, Review.Title)) %>% mutate(Poster = paste('<img src="', Poster, '" style="width: 100%;" />')))
```

Page 2
=====================================

Column {.sidebar}
-----------------------------------------------------------------------

<div style="height: 500px"></div>

```{r}
sliderInput('years', label = 'Range of Years', step=1, min=min(flat_movies$Year), max = max(flat_movies$Year), value = c(min(flat_movies$Year),max(flat_movies$Year)))
```

Column
-----------------------------------------------------------------------

### Rating for selected years

```{r}
renderPlot({
  years = reactive(input$years)
  
  filtered = flat_movies %>% filter(years()[1] < Year & Year < years()[2])
  
  ggplot(
    filtered,
    aes(x = Year, y = Rating, color = Genre)
) +
    geom_point(alpha = 0.5) +
    xlim(min(flat_movies$Year), max(flat_movies$Year)) + 
    scale_color_jco() +
    theme_bw() +
    theme(legend.title = element_blank())
  }, res = 96)
```

Page 3
=====================================

Column {.sidebar}
-----------------------------------------------------------------------

<div style="height: 500px"></div>

```{r}
genres = flat_movies$Genre %>% unique()
selectInput("genres", label = "Selected genres", choices = genres, selected = genres %>% sample(5), multiple = TRUE)
```

Column
-----------------------------------------------------------------------

### Rating for selected genres

```{r}
renderPlot({
  genres = reactive(input$genres)
  
  filtered = flat_movies %>% filter(Genre %in% genres())
  
  ggplot(
    filtered,
    aes(x = Year, y = Rating, color = Genre)
) +
    geom_point(alpha = 0.5) +
    xlim(min(flat_movies$Year), max(flat_movies$Year)) + 
    scale_color_jco() +
    theme_bw() +
    theme(legend.title = element_blank())
  }, res = 96)
```

Page 4
=====================================

### Plot

```{r}
p <- ggplot(
    flat_movies[sample(nrow(flat_movies), 1000), ],
    aes(x = Year, y = Rating, color = Genre)
) +
    geom_point(alpha = 0.5) +
    scale_color_jco() +
    theme_bw() +
    theme(legend.title = element_blank())

ggplotly(p)
```

About
=====================================

Column {data-width=650}
-----------------------------------------------------------------------
### About dataset

[IMDB Movies Dataset](https://www.kaggle.com/datasets/amanbarthwal/imdb-movies-data)

The IMDb Movies Dataset is one of the most extensive collections of movie-related data available. It includes a wide range of attributes such as titles, genres, cast and crew, release dates, ratings, and reviews. 

- Poster: link of the movie poster.
- Title: name of the movie.
- Year: year the movie was released.
- Certificate: age rating given to the movie (e.g., PG, R).
- Duration (min): length of the movie in minutes.
- Genre: genre(s) of the movie (e.g., Action, Comedy, Drama).
- Rating: IMDB user rating for the movie.
- Metascore: score from critics.
- Director: director(s) of the movie.
- Cast: main actors in the movie.
- Votes: number of votes the movie received on IMDB.
- Description: brief summary of the movie's plot.
- Review Count: total count of reviews.
- Review Title: title of the review.
- Review: movie review (review with highest votes on it).

This richness allows for in-depth analysis and insights into the film industry and audience preferences. It may be used in various scenarios - for example in recommendation system.

Column {data-width=350}
-----------------------------------------------------------------------

### About authors

- Bernart Mateusz 156072
- Janiak Patryk 156053

### Motivation

We want to get a nice grade ðŸ˜Š
